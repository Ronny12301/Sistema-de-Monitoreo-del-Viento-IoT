<!DOCTYPE html>
<html class="" lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Captura de datos en tiempo real del an√©mometro</title>

    <link href="../css/output.css" rel="stylesheet">
    <script defer src="./views/components/Navbar.js"></script>
    <script defer src="./views/components/Compass.js"></script>
    <script defer src="./views/components/Speedometer.js"></script>
    <script defer src="./views/components/WindDisplayVariables.js"></script>
</head>

<body class="bg-slate-50 dark:bg-gray-900 dark:text-white">
    <my-navbar>Captura de datos</my-navbar>  
    
    <display-variables></display-variables>

    <div class="flex bellow-sm:flex-col justify-center items-center md:absolute md:bottom-14 md:h-2/3 md:end-32">
        <my-speedometer class="my-[38px] mx-5"></my-speedometer>
        <my-compass class="my-[50px] mx-5 z-0"></my-compass>
    </div>

    <div class="md:absolute bottom-0 mb-4 start-2 end-2 py-3 shadow bg-sky-100 dark:bg-gray-600
        mx-8 sm:mx-36 md:mx-[30rem] lg:mx-[45rem] rounded-lg"
    >
        <p id="raw-string" class="text-2xl text-center">
            ---
        </p>
    </div>

    <div class="md:absolute bottom-1/2 md:left-[13%]">
        <a  href="#" id="focus-input"
            class="md:px-[200%] py-3 rounded-xl shadow 
                text-white text-lg font-medium text-center
                bg-green-500 hover:bg-green-600 active:bg-green-700
                dark:bg-green-600 dark:hover:bg-green-700 dark:active:bg-green-800
                bellow-md:absolute bellow-md:left-0 bellow-md:right-0
                bellow-sm:mx-8 bellow-md:sm:mx-36"
        >
            Registros
        </a>

        <input datepicker datepicker-buttons datepicker-autoselect-today readonly
            id="input-field" type="text" class="absolute -left-[200vw]"
        >
    </div>

    <script src="../js/update-message.js"></script>
    <script src="../js/dark-mode.js"></script>
    <script src="../js/date-formatting.js"></script>
    <script src="../js/flowbite-datepicker.js"></script>
    <script>
        document.getElementById("focus-input").addEventListener("click", function(event) {
            event.preventDefault();
            document.getElementById("input-field").focus();
        });

        document.body.addEventListener('click', function(event) {
            if (event.target.classList.contains('datepicker-cell')) {
                const dataDate = event.target.getAttribute('data-date');
                const d = getISODate(parseInt(dataDate));
                
                if (d === "NaN-NaN-NaN") {
                    return;
                }
                window.location.href = `/day?created_at=${d}`;
            }
            else if (event.target.classList.contains('today-btn')) {
                const today = new Date();
                const formattedDate = getISODate(today);
                window.location.href = `/day?created_at=${formattedDate}`;
            }
        });
    </script>

    <script>
        setInterval(updateMessage, 500);
    </script>
</body>
</html>